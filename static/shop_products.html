<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>My Products</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Space+Grotesk%3Awght%40400%3B500%3B700" />
    <style>
        .content-container { opacity: 0; transition: opacity 0.5s ease-in-out; }
        .content-container.loaded { opacity: 1; }
        .press-effect { transition: transform 0.1s ease-out; }
        .press-effect:active { transform: scale(0.97); }
    </style>
</head>
<body class="bg-gray-100">
    <div class="mx-auto max-w-sm">
        <div class="relative bg-[#fcfbf8] min-h-screen">
            <div class="pb-32">
                <div class="content-container">
                    <div class="flex items-center bg-[#fcfbf8] p-4 pb-2 justify-between sticky top-0 z-10 border-b border-[#f3f2e7]">
                        <h2 class="text-[#1c1a0d] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center">My Products</h2>
                    </div>
                    <div id="product-list-container" class="p-4 flex flex-col gap-3">
                        <!-- Product list will be injected here by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Floating Add Button -->
            <div class="fixed bottom-24 z-20 w-full max-w-sm flex justify-end pr-4">
                <a href="./shop_add_product.html" class="press-effect flex items-center justify-center size-14 rounded-full bg-[#f3dd39] text-[#1c1a0d] shadow-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path></svg>
                </a>
            </div>

            <!-- Navigation Bar -->
             <div class="fixed bottom-0 z-10 w-full max-w-sm">
                <div class="flex justify-around border-t border-[#f3f2e7] bg-[#fcfbf8] px-2 pb-3 pt-2">
                    <a class="flex flex-1 flex-col items-center justify-end gap-1 text-[#9b924b]" href="./shop_dashboard.html"><div class="flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48.11-.11a16,16,0,0,1,21.53,0l.11.11,80,75.48A16,16,0,0,1,224,115.55Z"></path></svg></div><p class="text-xs font-medium leading-normal tracking-[0.015em]">Dashboard</p></a>
                    <a class="flex flex-1 flex-col items-center justify-end gap-1 text-[#9b924b]" href="./shop_orders.html"><div class="flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M72,104a8,8,0,0,1,8-8h96a8,8,0,0,1,0,16H80A8,8,0,0,1,72,104Zm8,40h96a8,8,0,0,0,0-16H80a8,8,0,0,0,0,16ZM232,56V208a8,8,0,0,1-11.58,7.15L192,200.94l-28.42,14.21a8,8,0,0,1-7.16,0L128,200.94,99.58,215.15a8,8,0,0,1-7.16,0L64,200.94,35.58,215.15A8,8,0,0,1,24,208V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56Zm-16,0H40V195.06l20.42-10.22a8,8,0,0,1,7.16,0L96,199.06l28.42-14.22a8,8,0,0,1,7.16,0L160,199.06l28.42-14.22a8,8,0,0,1,7.16,0L216,195.06Z"></path></svg></div><p class="text-xs font-medium leading-normal tracking-[0.015em]">Orders</p></a>
                    <a class="flex flex-1 flex-col items-center justify-end gap-1 text-[#1c1a0d]" href="./shop_products.html"><div class="flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M216,56H88a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16ZM44,52A12,12,0,1,0,56,64,12,12,0,0,0,44,52Zm44,72H216a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16Zm128,56H88a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16ZM44,116a12,12,0,1,0,12,12A12,12,0,0,0,44,116Zm0,64a12,12,0,1,0,12,12A12,12,0,0,0,44,180Z"></path></svg></div><p class="text-xs font-medium leading-normal tracking-[0.015em]">Products</p></a>
                    <a class="flex flex-1 flex-col items-center justify-end gap-1 text-[#9b924b]" href="./shop_settings.html"><div class="flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M230.93,220a8,8,0,0,1-6.93,4H32a8,8,0,0,1-6.92-12c15.23-26.33,38.7-45.21,66.09-54.16a72,72,0,1,1,73.66,0c27.39,8.95,50.86,27.83,66.09,54.16A8,8,0,0,1,230.93,220Z"></path></svg></div><p class="text-xs font-medium leading-normal tracking-[0.015em]">Profile</p></a>
                </div>
            </div>
        </div>
    </div>
    <script src="shop_logic.js"></script>
    <script>
        function createProductRowHTML(product) {
            return `
            <div class="flex items-center gap-4 bg-white p-3 rounded-lg border border-[#e5e2d0] shadow-sm justify-between">
                <div class="flex items-center gap-4 min-w-0">
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-lg size-14 flex-shrink-0" style="background-image: url('${product.image_url}');"></div>
                    <div class="flex flex-col justify-center min-w-0">
                        <p class="text-[#1c1a0d] text-base font-medium leading-normal truncate">${product.name}</p>
                        <p class="text-[#9b924b] text-sm font-bold leading-normal">$${product.price.toFixed(2)}</p>
                    </div>
                </div>
                <div class="shrink-0">
                    <a href="./shop_edit_product.html?id=${product.id}" class="press-effect text-[#1c1a0d] flex size-9 items-center justify-center rounded-full hover:bg-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256"><path d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"></path></svg>
                    </a>
                </div>
            </div>`;
        }
        
        async function fetchProducts() {
            if (!user.shop_id) return;
            const productListContainer = document.getElementById('product-list-container');
            try {
                const response = await fetch(`/products/shop/${user.shop_id}`);
                const products = await response.json();
                
                productListContainer.innerHTML = '';
                if (products.length > 0) {
                    products.forEach(product => {
                        productListContainer.innerHTML += createProductRowHTML(product);
                    });
                } else {
                    productListContainer.innerHTML = '<p class="text-center text-gray-500 py-8">You have not added any products yet.</p>';
                }
            } catch (error) {
                console.error("Error fetching products:", error);
                productListContainer.innerHTML = '<p class="text-red-500 p-4">Could not load products.</p>';
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.content-container').classList.add('loaded');
            fetchProducts();
        });
    </script>
</body>
</html>